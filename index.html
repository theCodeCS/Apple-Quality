<!DOCTYPE html>
<html>
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1, shrink-to-fit=no"
    />
    <title>Apple Quality App</title>
  </head>
  <p>
    This dataset presents a rich compilation of attributes for a collection of fruits, 
    offering in-depth insights into their physical and taste-related characteristics, 
    including specifics like fruit ID, size, weight, sweetness, crunchiness, juiciness, ripeness, acidity, 
    and an overall quality rating. Each aspect has been carefully catalogued, providing a broad spectrum of 
    data to underpin fruit quality and edibility analysis. In our exploratory analysis, we harness the power 
    of advanced machine learning models, such as XGBoost and CatBoost, to sift through this wealth of information, 
    identifying patterns and predictors of fruit quality that may not be immediately apparent. 
    Furthermore, we leverage Streamlit to bring this dataset to life through dynamic data visualization techniques. 
    Streamlit's interactive capabilities allow us to create a user-friendly interface where the multifaceted nature 
    of our fruit quality dataset can be explored and visualized from multiple angles, making the insights accessible 
    to a wider audience. This approach not only enhances our understanding of what defines fruit quality but also 
    showcases the potential of combining sophisticated machine learning algorithms with intuitive data presentation 
    tools to analyze and interpret complex datasets.
  </p>
  <body>
    <div id="root"></div>
    <script src="https://cdn.jsdelivr.net/npm/@stlite/mountable@0.52.1/build/stlite.js"></script>
    <script>
    stlite.mount(
  {
    requirements: ["streamlit", "pandas", "matplotlib", "seaborn", "xgboost", "joblib", "pyautogui"],
    entrypoint: "myapp.py",
    files: {
      "myapp.py": `
      import streamlit as st
      import pandas as pd
      import numpy as np
      import matplotlib.pyplot as plt
      import seaborn as sns
      import xgboost as xgb
      from joblib import load
      import pyautogui
      
      # Load the dataset
      st.title("""
               **Is your Apple Good or Bad Quality? Lets find out!**
               """)
      
      df = pd.read_csv('apple_quality.csv')
      
      ################## Preprocessing ##################
      df.drop(['A_id', 'Quality'], axis=1, inplace=True)
      
      target = {0: 'Bad Quality', 1: 'Good Quality'}
      
      # Remove last row
      df.drop(df.tail(1).index, inplace=True)
      
      # Change typing of Acidity to float
      df['Acidity'] = df['Acidity'].astype(float)
      
      ################## Sidebar ##################
      st.dataframe(df, height=250)
      
      # # Add a selectbox to the sidebar:
      st.sidebar.header('User Input Features')
      
      # Collects user input features into dataframe
      def user_input_features():
          size = st.sidebar.slider('Size', df['Size'].min(), df['Size'].max(), df['Size'].mean())
          weight = st.sidebar.slider('Weight', df['Weight'].min(), df['Weight'].max(), df['Weight'].mean())
          sweetness = st.sidebar.slider('Sweetness', df['Sweetness'].min(), df['Sweetness'].max(), df['Sweetness'].mean())
          crunchiness = st.sidebar.slider('Crunchiness', df['Crunchiness'].min(), df['Crunchiness'].max(), df['Crunchiness'].mean())
          juciness = st.sidebar.slider('Juiciness', df['Juiciness'].min(), df['Juiciness'].max(), df['Juiciness'].mean())
          ripeness = st.sidebar.slider('Ripeness', df['Ripeness'].min(), df['Ripeness'].max(), df['Ripeness'].mean())
          acidity = st.sidebar.slider('Acidity', df['Acidity'].min(), df['Acidity'].max(), df['Acidity'].mean())
          data = {'Size': size,
                  'Weight': weight,
                  'Sweetness': sweetness,
                  'Crunchiness': crunchiness,
                  'Juiciness': juciness,
                  'Ripeness': ripeness,
                  'Acidity': acidity
                  }
          features = pd.DataFrame(data, index=[0])
          return features
      
      input_df = user_input_features()
      
      if st.sidebar.button("Reset"):
          pyautogui.hotkey('ctrl', 'r')
      
      st.write('The user input features are:', input_df)
      
      ################## Model Prediction ##################
      
      # Load xgboost pipeline model from joblib file
      xgb_new = load('apple_quality_xgb.joblib')
      
      # Apply model to make predictions
      st.subheader('Prediction')
      
      # Apply model to make predictions
      prediction = xgb_new.predict(input_df)
      
      if prediction[0] == 0:
          st.write('This apple is of bad quality.')
          st.image('images/bad_apple.png', use_column_width=True)
      else:
          st.write('This apple is of good quality.')
          st.image('images/good_apple.jpg', use_column_width=True)
      
      
`,
    },
  },
  document.getElementById("root")
);
    </script>
  </body>
</html>